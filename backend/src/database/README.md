# API Reference

## **Introduction**

### **Getting Started**
- Base URL: Coffee Shop app can only be run locally and is not hosted. This means there is no base url. Backend, this application is hosted at, `http://127.0.0.1:5000/`, which is set as a proxy in the frontend configuration. 
- Authentication: This version of the application requires aythentication. Certain requests require a token to be sent in the header. This token is generated by the backend.

### **Error Handling**
Errors are returned as JSON objects in the following format:
```
{
    "success": False, 
    "error": 404,
    "message": "Resource not found"
}
```
The API will return seven error types when requests fail. They include:
- 400: Bad Request
- 404: Resource Not Found
- 422: Not Processable 
- 500: Internal Server Error
- 405: Method Not Allowed
- 401: Unauthorized
- 403: Forbidden

It also raises an AssertionError if the request is not valid.

### **Endpoints Library** 
#### _GET **/drinks**_
- General:
    - A public endpoint to get a list of drinks.
    - Fetches a dictionary of drinks in which the keys is drinks (string) and the values are the corresponding drink name and drink details respectively. Also includes a success value.
    - Request Arguments: None
    - Sample: `curl http://127.0.0.1:5000/drinks`

    ```
    {
    "drinks": [
        {
        "id": 1, 
        "recipe": [
            {
            "color": "blue", 
            "parts": 1
            }
        ], 
        "title": "Water"
        }
    ],
    "success": true
  }
    ```
#### _GET **/drinks-detail**_
- Authorization:
    - A secured endpoint to get a list of short drinks details Manager and Barista role allowed.
    - Fetches a dictionary of drinks in which the keys is drinks (string) and the values are the corresponding drink name and drink details respectively. Also includes a success value.
    - Request Arguments: Authorization token (Bearer<token>)
    - Sample: ` curl --location --request GET 'localhost:5000/drinks-detail' --header 'Authorization: Bearer <token>'`

    ```
    {
    "drinks": [
        {
        "id": 1, 
        "recipe": [
            {
            "color": "blue", 
            "parts": 1
            }
        ], 
        "title": "Water"
        }
    ],
    "success": true
    }
    ```

#### _POST **/drinks**_
- Authorization:
    - A secured endpoint to create a new drink. Only individuals with Manager role can make this request.
    - Request Arguments: Authorization token (Bearer<token>), JSON object with the following keys:
        - title: (string) The title of the drink.
        - recipe: (array) An array of objects with the following keys:
            - color: (string) The color of the drink.
            - parts: (integer) The number of parts of the drink.
    - Sample: `curl --location --request POST 'localhost:5000/drinks' --header 'Content-Type: application/json' --header 'Authorization: Bearer <token>' --data-raw '{
    "title": "Water3",
    "recipe": {
        "name": "Water",
        "color": "blue",
        "parts": 1
    }
}'`
```
{
    "drinks": [
        {
            "id": 2,
            "recipe": {
                "color": "blue",
                "name": "Water",
                "parts": 1
            },
            "title": "Water3"
        }
    ],
    "success": true
}
```

#### _PATCH **/drinks/id**_
- Authorization:
    - A secured endpoint to update a drink detail. Only individuals with Manager role can make this request.
    - Request Arguments: Authorization token (Bearer<token>),
        - id: (integer) The id of the drink.
        - title: (string) The title of the drink.
        - recipe: (array) An array of objects with the following keys:
            - color: (string) The color of the drink.
            - parts: (integer) The number of parts of the drink.
    - Sample: `curl --location --request PATCH 'localhost:5000/drinks/id' --header 'Content-Type: application/json' --header 'Authorization: Bearer <token>' --data-raw '{    "id": 2, 
    "recipe": [{"color": "tan", "name": "milk", "parts": 1}, {"name": "grass", "color": "green", "parts": 2}], 
    "title": "Veggie. Smoothie"
    }'`
    ```
    {
    "drinks": [
        {
            "id": 1,
            "recipe": [
                {
                    "color": "tan",
                    "name": "milk",
                    "parts": 1
                },
                {
                    "color": "green",
                    "name": "grass",
                    "parts": 2
                }
            ],
            "title": "Veggie. Smoothie"
        }
    ],
    "success": true
    }
    ```

#### _DELETE **/drinks/id**_
- Authorization:
    - A secured endpoint to delete a drink. Only individuals with Manager role can make this request.
    - Request Arguments: Authorization token (Bearer<token>),
        - id: (integer) The id of the drink.
    - Sample: `curl --location --request DELETE 'localhost:5000/drinks/id' --header 'Content-Type: application/json' --header 'Authorization: Bearer <token>' --data-raw '{
    "id": 2
}'`
```
{
    "delete": 2,
    "success": true
}
```
